<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head><link rel="stylesheet" type="text/less" href="../stylesheets/less/default.less"/><script type="text/javascript" src="../javascripts/less-1.3.0.min.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1187.37">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 22.0px 'Hiragino Kaku Gothic ProN'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; min-height: 18.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Hiragino Kaku Gothic ProN'}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 24.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #001e57; min-height: 36.0px}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 24.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #001e57}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Hiragino Kaku Gothic ProN'; background-color: #001e57; min-height: 27.0px}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; background-color: #ebebeb}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 24.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #9e3517; min-height: 36.0px}
    p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 24.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #9e3517}
    p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Hiragino Kaku Gothic ProN'; background-color: #9e3517; min-height: 27.0px}
    p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 20.0px 'Hiragino Kaku Gothic ProN'}
    p.p14 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    p.p15 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; background-color: #ebebeb}
    p.p16 {margin: 0.0px 0.0px 10.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #ffffff; background-color: #458847}
    p.p17 {margin: 0.0px 0.0px 10.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; min-height: 18.0px}
    p.p18 {margin: 0.0px 0.0px 0.0px 0.0px; font: 24.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #17546d; min-height: 36.0px}
    p.p19 {margin: 0.0px 0.0px 0.0px 0.0px; font: 24.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #17546d}
    p.p20 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Hiragino Kaku Gothic ProN'; background-color: #17546d; min-height: 27.0px}
    p.p21 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #01546e}
    p.p22 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #00546f}
    p.p23 {margin: 0.0px 0.0px 0.0px 0.0px; font: 30.0px 'Hiragino Kaku Gothic ProN'}
    p.p24 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #005470; min-height: 27.0px}
    p.p25 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #005470}
    p.p26 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #005471; min-height: 27.0px}
    p.p27 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Hiragino Kaku Gothic ProN'; color: #ffffff; background-color: #005471}
    span.s1 {font: 12.0px Helvetica}
    span.s2 {background-color: #ebebeb}
    span.s3 {font: 12.0px 'Hiragino Kaku Gothic ProN'}
    span.s4 {text-shadow: 0.0px -1.0px 0.0px #ffffff}
    span.s5 {font: 18.0px Helvetica}
    span.Apple-tab-span {white-space:pre}
  </style>
</head>
<body>
<p class="p1"><b>SublimeSocket API Reference 1.1.3</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>Overview</b></p>
<p class="p4"><span class="Apple-tab-span">	</span>SublimeTextのAPIを、WebSocket経由で実行するためのサーバです。</p>
<p class="p4"><span class="Apple-tab-span">	</span>SublimeTextのプラグインとして実装されています。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>WebSocket(RFC6455)によって、Local, Remoteの環境と組み合わせて動作します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>文章中では、SublimeTextのことをST、SublimeSocketのことをSSと略機することがあります。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4"><b>用途</b></p>
<p class="p4"><span class="Apple-tab-span">	</span>・SublimeSocketAPIを組み合わせてReactorをプログラミングし、ST上にログ情報を表示</p>
<p class="p4"><span class="Apple-tab-span">	</span>・ST上での特定のアクションに応じてコンパイル処理を走らせる</p>
<p class="p4"><span class="Apple-tab-span">	</span>・Remote環境のコンパイラとLocal環境のSTの連携</p>
<p class="p4"><span class="Apple-tab-span">	</span>・端末上のWebSocketクライアントとSTの連携</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4"><b>想定している連携例</b></p>
<p class="p4"><b><span class="Apple-tab-span">	</span></b><span class="s1"><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202013-04-05%2013.27.48.png" alt="スクリーンショット 2013-04-05 13.27.48.png"></span></p>
<p class="p4"><span class="Apple-tab-span">	</span>サーバ側から、Log、StackTrace、SublimeSocketAPIなどの文字列データをSublimeSocketへと送付</p>
<p class="p4"><span class="Apple-tab-span">	</span>↓</p>
<p class="p4"><span class="Apple-tab-span">	</span>SublimeSocketがデータ受信、API受付</p>
<p class="p4"><span class="Apple-tab-span">	</span>↓</p>
<p class="p4"><span class="Apple-tab-span">	</span>SublimeTextに表示、編集アシスト動作</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>SublimeTextからキーイベント発行</p>
<p class="p4"><span class="Apple-tab-span">	</span>↓</p>
<p class="p4"><span class="Apple-tab-span">	</span>SublimeSocket イベント着火</p>
<p class="p4"><span class="Apple-tab-span">	</span>↓</p>
<p class="p4"><span class="Apple-tab-span">	</span>SublimeSocketからサーバ上のコンパイラにコンパイルオーダー</p>
<p class="p4"><span class="Apple-tab-span">	</span>↓</p>
<p class="p4"><span class="Apple-tab-span">	</span>サーバ側でコンパイル</p>
<p class="p4"><span class="Apple-tab-span">	</span>↓</p>
<p class="p4"><span class="Apple-tab-span">	</span>…</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>ずっとSublimeTextのターン！！</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p2"><br></p>
<p class="p5"><b></b><br></p>
<p class="p6"><b>API記法について</b></p>
<p class="p7"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>SSJSON (SublimeSocketJSON)</b></p>
<p class="p4"><span class="Apple-tab-span">	</span>JSONに特定の文字列をつけて、APIの実行キーにしています。</p>
<p class="p4"><span class="Apple-tab-span">	</span>下記の文字で構成された文字列を受け取る事で、APIを実行します。</p>
<p class="p2"><b></b><br></p>
<p class="p4"><b>Prefix</b></p>
<p class="p8">API_PREFIX = "sublimesocket"</p>
<p class="p8">API_PREFIX_SUB = "ss"</p>
<p class="p4"><span class="Apple-tab-span">	</span>特にSublimeServer向けの情報である事を示すPrefixです。</p>
<p class="p4"><span class="Apple-tab-span">	</span>ぱっと見で明示するために付いています。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>フルに書くのがめんどくさい場合、ssで済ます事が出来ます。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4"><b>HeaderDelimiter</b></p>
<p class="p8">API_DEFINE_DELIM = "@"<span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>ここから先がAPIのKey<span class="s1">s</span> and Values、という事を示すデリミタです。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4"><b>Concat</b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p8">API_CONCAT_DELIM = "-&gt;"</p>
<p class="p4"><span class="Apple-tab-span">	</span>API同士を接続するデリミタです。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>下記のように使用します。</p>
<p class="p8">ss@API-&gt;API-&gt;API</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>-&gt; で連結したAPIは、記述順を守って実行されます。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><b>Parameters</b></p>
<p class="p8">ss@Command1:JSON</p>
<p class="p2"><br></p>
<p class="p8">ss@Command1:JSON-&gt;Command2:JSON-&gt;Command3:JSON,,,</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>JSON部分の内容は、各APIごとに必須パラメータ名、型が決められています。</p>
<p class="p4"><span class="Apple-tab-span">	</span>また、パラメータ無しのAPIは、JSON部分無しで実行する事が出来ます。</p>
<p class="p2"><br></p>
<p class="p8">ss@Command1</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4"><b>Comment</b></p>
<p class="p8">API_COMMENT_DELIM<span class="Apple-tab-span">	</span>= "/"</p>
<p class="p4"><span class="Apple-tab-span">	</span>@とAPI名の間に記述する事が出来ます。/で閉じます。</p>
<p class="p2"><br></p>
<p class="p8">ss@コメント/API-&gt;...</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4"><b>値渡し</b></p>
<p class="p4"><span class="Apple-tab-span">	</span>Returnが定義されているAPIの場合、</p>
<p class="p4"><span class="Apple-tab-span">	</span>(<span class="s1">Source</span>Key|TargetKey)をAPI名の前に書く事で、直前のAPIの結果値を渡すことが出来ます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><b>1.0では特定APIにしか対応していませんが、1.1では全APIで対応する予定です。</b></p>
<p class="p8">ss@commandA:{"key1":"value"}-&gt;(key1|key2)commandB:{"key2":"will be replaced."}</p>
<p class="p4"><span class="Apple-tab-span">	</span>commandA の key1 に入った値を、commandB の key2 へと入力して実行します。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>Sample API</b></p>
<p class="p4"><span class="Apple-tab-span">	</span>下記は、STのログに "Hello World" を出すAPIのサンプルです。</p>
<p class="p8">ss@ハローワールドです/showAtLog:{"message":"Hello World"}</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>色々なAPIを、SublimeSocket Test Console で試す事が出来ます。</p>
<p class="p4"><span class="Apple-tab-span">	</span>CommandPalette -&gt; "SublimeSocket: on &gt; open preference" で、SublimeTextからSafariなどブラウザが起動します。</p>
<p class="p9"><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202013-06-10%2018.55.42.png" alt="スクリーンショット 2013-06-10 18.55.42.png"></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s1">i</span>nput に対して<span class="s2">ss@showAtLog:{"message":"Hello World"}</span>を入力した状態でInputボタンを押すと、SublimeText内のコンソールに ss:Hello World と表示されているはずです。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s1"><img src="c.png" alt="c.png"></span></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p10"><b></b><br></p>
<p class="p11"><b>API Reference</b></p>
<p class="p12"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>versionVerify</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Client側から想定しているST、SSのVersionを入力し、SSのVersion、SSのAPIVersionとの整合性チェックを行います。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SSには、SS自体のversion と、SSのAPIのversionの２つのレイヤーがあります。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SSのversion = SublimeText 2 or 3 のどちらに対応しているか</p>
<p class="p9"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SSAPIの</span>version = SublimeSocket API <span class="s3">の</span>version</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>socketVersion[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Client側が想定しているSublimeSocketのversionの文字列です。"major.minor.changeLevel"</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Client側の指定したversionと一致しない場合、そのクライアントとのコネクションは切断されます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>apiVersion[bool]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Client側が想定しているSSAPIのversionの文字列です。 "major.minor.changeLevel"</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>以下のケースが発生します。</p>
<p class="p4"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>major version について</b></p>
<p class="p4"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>client &lt; server で切断、clientの</b><span class="s1"><b>update</b></span><b>を促す</b></p>
<p class="p4"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>client = server でminorのチェックに入る</b></p>
<p class="p4"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>client &gt; server で切断、SSのupdateを促す</b></p>
<p class="p2"><b></b><br></p>
<p class="p4"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>minor version について</b></p>
<p class="p4"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>client &lt; server で、OK、かつclientのupdateを促す(可能であれば)</b></p>
<p class="p4"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>client = server で、OK。</b></p>
<p class="p4"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>client &gt; server で切断、SSのupdateを促す</b></p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g.</p>
<p class="p8">ss@versionVerify:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"socketVersion": "0.0.1",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"apiVersion": "0.0.1"</p>
<p class="p8">}</p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>runSetting</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>テキストファイルとして保存されているAPIを読み込み、実行します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>path[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>読み込むファイルのパスです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SUBLIMESOCKET_PATH:と付ける事で、SublimeSocketフォルダ内を参照するようにショートカットができます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. /Users/someone/Desktop//UnityFilter.txt ファイルを読み込み、APIとして実行</p>
<p class="p8">ss@runSetting:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"path": "/Users/someone/Desktop/UnityFilter.txt"</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>inputIdentity</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeSocket WebSocketのコネクションに名前をつける事が出来ます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>id[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>コネクションに付ける名前です。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SSを中継して他Clientにメッセージを送る際などの宛名に使用します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. 送付元のClientのidをmyClientにする。</p>
<p class="p8">ss@inputIdentity:{"id":"myClient"}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>tearDown</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SSのWebSocket service を終了します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. SSのサーバを落とす。</p>
<p class="p8">ss@ tearDown</p>
<p class="p4"><span class="Apple-tab-span">	</span>(バグがあり、socket自体はそのまま生存、address already use が出てしまう　2013/04/05 10:35:52)</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>setReactor</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeSocketに対して、特定のEventが発生した場合に動く、Reactorをセットします。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>eventとtargetの組み合わせによって、特定のEventに対して複数の動作をセットすることが可能です。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>event[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>監視する対象のEvent名　"on_modified", "on_selection_modified", "on_pre_save", "on_post_save" など、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeTextが発行するものと、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>"event_"で始まる語句で、独自のイベントを定義できます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>target[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Reactorの識別に使用します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>異なるtargetを設定する事で、同じEventに対して複数のReactorをセットする事が出来ます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>selectors[JSONArray[JSONObject[string:any]]]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Event発生時に動作するAPIを記述できます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>記述はJSONの配列形式で、APIのCommand部分を文字列キーにしたJSonObjectが使えます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>interval[int]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>実行間隔の数値です。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0であればセット直後に一度だけ対象Eventの発生をチェックします。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0以外の正の数であれば、ミリ秒ごとに対象Eventの発生をチェックします。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>replacefromto[JSONObject[string:string]]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Reactor発生時、Eventの持つパラメータを、selectorで指定したAPIに適応させる事が出来ます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>{key:value}に対して、 Eventの持つkey名のパラメータの値を、selector内のvalue名のパラメータの値にします。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. 選択範囲が更新されたら、STのログにHello Worldと表示する。1秒ごとに実行される</p>
<p class="p8">ss@setReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "on_selection_modified",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"showAtLog": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"message": "Hello World"</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>],</p>
<p class="p8"><span class="Apple-converted-space">    </span>"replacefromto": {</p>
<p class="p8"><span class="Apple-converted-space">        </span>"view": "view"</p>
<p class="p8"><span class="Apple-converted-space">    </span>},</p>
<p class="p8"><span class="Apple-converted-space">    </span>"interval": 1000</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>setFoundationReactor</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ST上で発生する特殊なEventに対してReactorをセットします。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Eventについては下記<b>EventReference</b>参照</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>event[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>対象Event名です。”ss_f_noViewFound”　などが該当します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>あるビュー(ファイル)に対する操作が発生したとき、そのビューが現在開かれていない際に発行されます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>条件があり、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>・defineFilterが定義済み</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>・そのfilterにヒットするfilteriingが流入し</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>・対象ビューが探知できなかった</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>場合に発生します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>selectors</p>
<p class="p4"><span class="Apple-tab-span">	</span>replacefromto</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>同 setReactor</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. Reactorセット後、フィルタ定義をし、そのフィルタにヒットするも該当するビューが開かれていない場合、STログにHello Worldを出力する。</p>
<p class="p8">ss@setFoundationReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "ss_f_noViewFound",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"showAtLog": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"message": "Hello World"</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>]</p>
<p class="p8">}</p>
<p class="p8">-&gt;defineFilter:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"name": "04/04/13 23:30:08",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"patterns": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"something": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">                    </span>{</p>
<p class="p8"><span class="Apple-converted-space">                        </span>"showAtLog": {</p>
<p class="p8"><span class="Apple-converted-space">                            </span>"message": "Hello World"</p>
<p class="p8"><span class="Apple-converted-space">                        </span>}</p>
<p class="p8"><span class="Apple-converted-space">                    </span>}</p>
<p class="p8"><span class="Apple-converted-space">                </span>]</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>]</p>
<p class="p8">}</p>
<p class="p8">-&gt;filtering:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"name": "04/04/13 23:30:08",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"source": "something"</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>kvs</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SS内のKey value storeを扱うAPIです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>内部的にはPythonの辞書で実装されています。　この機能の実装は、そのまま別のKVSへとすげ替える事を念頭に隔離して実装されています。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>showAll[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>全パラメータを文字列にSerializeしてClientへと返します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>valueの意味はありません。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>showValue[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>valueにしたパラメータをkeyに持つ値を返します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>辞書や配列の場合、Serializeしたものを返します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>removeValue[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>valueにしたパラメータをkvsから削除します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>clear[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>kvsを空にします。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>valueの意味はありません。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. kvsを空にする。</p>
<p class="p8">ss@kvs:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"clear": "true"</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>defineFilter</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SSへとデータが流し込まれた際に反応するフィルタを定義します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>定義されたフィルタはkvsへと保存され、特定のデータに対して反応します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>name[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>フィルタをidentifyするための文字列です。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>filtering APIと合わせて使用します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>patterns[JSONArray[JSONObject[string:any]]]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>正規表現をkeyにしたJSONObjectの配列です。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>keyにマッチするデータが流入した場合、value内のselectorsがAPIとして発生します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>複数の正規表現を書いた場合、配列順に実行されます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>複数のフィルタにマッチすることを許します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. 2013/04/04 23:30:08 という名前で、somethingで始まるデータが流入した場合、STログにHello World を出力する。</p>
<p class="p8">ss@defineFilter:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"name": "04/04/13 23:30:08",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"patterns": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"^something": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">                    </span>{</p>
<p class="p8"><span class="Apple-converted-space">                        </span>"showAtLog": {</p>
<p class="p8"><span class="Apple-converted-space">                            </span>"message": "Hello World"</p>
<p class="p8"><span class="Apple-converted-space">                        </span>}</p>
<p class="p8"><span class="Apple-converted-space">                    </span>}</p>
<p class="p8"><span class="Apple-converted-space">                </span>]</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>]</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>filtering</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SSへとデータを流し込むAPIです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>任意の文字列データをClientからSSへと流し込みます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>name[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ターゲットとなるフィルタをidentifyする文字列です。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>事前にdefineFilterでセットされている必要があります。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>source[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>文字列データです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>APIの都合上、JSONで扱えない文字と、-&gt; (-と&gt;の連続) が入っている文字列を扱う事が出来ません。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>これらは事前にパースするとかでなんとかしてください。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>debug[bool]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>デバッグ用パラメータです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>セットされている場合はvalueに応じてデバッグ表示がSTのログに出力されます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. 2013/04/04 23:30:08 という名前が付けられたフィルタに対して、something という文字列を出力する。</p>
<p class="p8">ss@filtering:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"name": "04/04/13 23:30:08",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"source": "something"</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>containsRegions</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>通常、setReactorに内包して使用します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>特定のview(STで開かれているファイル)について、Reactorが指定したEventが発生したタイミングで、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>エディタの選択範囲にSTのRegionが存在する場合、emitキーワードで指定したEventを発行します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>発行できるEventは、"event_" 句で始まっていればOKで、自由に定義できます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Eventについては下記<b>EventReference</b>参照</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>view[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>viewのファイルのパスです。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>target[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>この文字列をtargetとして持つsetReactorへと、Eventを発行します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>emit[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Event名の文字列です。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event_で開始していればOKです。　event_errorEmitted などが指定できます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>debug[bool]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>デバッグ用パラメータです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>セットされている場合はvalueに応じてデバッグ表示がSTのログに出力されます。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g.<span class="Apple-converted-space">  </span>ファイル /Users/USERNAME/Library/Application Support/Sublime Text 2/Packages/SublimeSocket/SublimeSocketAPISettings.py に対して、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10行目にRegionが表示されます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1"><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202013-04-05%200.19.31.png" alt="スクリーンショット 2013-04-05 0.19.31.png"></span></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>そのRegionをカーソルが選択範囲に含んだ際、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>sublimesocketpreference というtargetをもち、event_errorEmitted Eventに反応するReactorに対して、Eventを発行します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>viewパラメータは something Reactorのreplacefromtoによって、on_selection_modifiedが発生したviewへと置き換えられます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Event発行後、event_errorEmitted に反応するReactorが発生し、Hello WorldがSTのログに出力され、 appendRegionの内容が実行されます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1"><img src="b.png" alt="b.png"></span></p>
<p class="p8">ss@setReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "on_selection_modified",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"containsRegions": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"view": "will be replace to specific view",</p>
<p class="p8"><span class="Apple-converted-space">                </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">                </span>"emit": "event_errorEmitted",</p>
<p class="p8"><span class="Apple-converted-space">                </span>"debug": true</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>],</p>
<p class="p8"><span class="Apple-converted-space">    </span>"replacefromto": {</p>
<p class="p8"><span class="Apple-converted-space">        </span>"view": "view"</p>
<p class="p8"><span class="Apple-converted-space">    </span>},</p>
<p class="p8"><span class="Apple-converted-space">    </span>"interval": 1000</p>
<p class="p8">}</p>
<p class="p8">-&gt;setReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "event_errorEmitted",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"showAtLog": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"message": "Hello World"</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>]</p>
<p class="p8">}</p>
<p class="p8">-&gt;appendRegion:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"view": "/Users/USERNAME/Library/Application Support/Sublime Text 2/Packages/SublimeSocket/SublimeSocketAPISettings.py",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"identity": "03/12/13 18:46:17",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"line": 10,</p>
<p class="p8"><span class="Apple-converted-space">    </span>"message": "herecomes daredevil",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"condition": "keyword"</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>collectViews</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>STが開いているviewを収集し、kvsに保存します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>特にパラメータはありません。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SS起動時に自動的に呼ばれます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>→SS起動時に自動的に実行されるAPIは、SSパッケージ内の SublimeSocket.sublime-settings に記述されています。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>"loadSettings" : ["collectViews"]</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. ST上で開いているviewを収集する。</p>
<p class="p8">ss@collectViews</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>runShell</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SSからPythonを経由してシェルスクリプトを実行します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bashなどの環境変数は引き継がれません。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>main, delay, debug　以外の文字列 "-a" や "something" などは、 そのままコマンドラインで実行されます。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>☆shell実行する都合上、value側に含まれるスペースを含む文字列 "a peaceful journey" などは、spaceが_に変換されます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>他にも、"[" -&gt; "", "]" -&gt; "",<span class="Apple-converted-space">  </span>"@s@s@" -&gt; " " へと変換が発生します。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>たとえばspaceを表示したい場合、SSへと入力する前の段階で、@s@s@ などに変換しておく必要があります。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>これは　"　をエスケープして文字列を囲んだ場合でもきちんと発生します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>main[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>コマンドラインの先頭に入る文字列です。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>delay[int]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>指定ミリ秒後に実行します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>debug</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>デバッグ用パラメータです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>セットされている場合はvalueに応じてデバッグ表示がSTのログに出力されます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>上記以外のkey[any]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>value部分には、string, int, bool のほか、 JSONArray[any] の指定が可能です。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>JSONObject形式で書いた場合、順がシャッフルされる可能性に注意してください。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>また、key、valueともに、空文字の指定が可能です。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. ruby gems　"terminal-notifier"を実行します。文字列中のspaceは、_に強制的に変換されます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>JSONObject版　key value の内容が、コマンドラインのパラメータとして実行されます。key-valueペアの順は守られますが、ペア同士がどの順で記述されるかは未定義です。</p>
<p class="p8">ss@runShell:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"main": "terminal-notifier",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"-message": "\"Hello, this is my message\"",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"-title": "\"Message Title\"",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"-execute": "\"open -a 'Sublime Text 2.App'\"",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"debug": true</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>JSONArray版　terminal-notifier -message "Hello,_this_is_my_message" -title "Message_Title" -execute "open_-a_'Sublime Text 2.App'" が実行されます。</p>
<p class="p8">ss@runShell:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"main": "terminal-notifier",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"-message": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>"\"Hello, this is my message\"",</p>
<p class="p8"><span class="Apple-converted-space">        </span>"-title",</p>
<p class="p8"><span class="Apple-converted-space">        </span>"\"Message Title\"",</p>
<p class="p8"><span class="Apple-converted-space">        </span>"-execute",</p>
<p class="p8"><span class="Apple-converted-space">        </span>"\"open -a 'Sublime Text 2.App'\""</p>
<p class="p8"><span class="Apple-converted-space">    </span>],</p>
<p class="p8"><span class="Apple-converted-space">    </span>"debug": true</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>broadcastMessage/monocastMessage</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SSを介して、他のClientへとWebSocket経由でメッセージを飛ばします。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>target</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>monocastMessageの場合のみ有効な、送付先のIdentityです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>inputIdentity を使う事で、Client側が自己申告できます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>実行時点でSS上に存在しないidentityを指定した場合、エラーが発生します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>message[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Clientへと送付される文字列です。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>sender[stirng]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>オプションです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>送付元の情報をidentifyする事が出来ます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>このキーがあることで、Clientへと到達する情報は、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>senderのvalue:messageのvalue になります。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g.</p>
<p class="p8">ss@monocastMessage:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"message": "here comes Daredevil! for only one",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference"</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>showAtLog</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>文字列をSTのログに出力します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>主にユーザーへの通知や、動作確認に使用します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>message[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ログに出力される文字列です。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g.</p>
<p class="p8">ss@showAtLog:{"message":"Hello World"}</p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>appendRegion</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>STで現在開かれている特定のviewへと、Region<span class="s1">(</span>四角形<span class="s1">)</span>を表示します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>情報はkvsのSUBDICT_REGIONS下に保存されます。　eraseAllR<span class="s1">e</span>gions が発生したタイミングで、削除されます。</p>
<p class="p14"><br></p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>メッセージ情報他を埋め込むことができます。</p>
<p class="p14"><br></p>
<p class="p9"><span class="Apple-tab-span">	</span>view[string]</p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>ファイル名を含む<span class="s1">path</span>です。</p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>フルパスが存在する場合、そのままviewを特定する要素として使用されます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>フルパスでない場合、適当に推測します。</p>
<p class="p14"><br></p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>最低でもファイル名<span class="s1">.</span>拡張子を含んでいる必要があります。</p>
<p class="p14"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>該当する<span class="s1">view</span>がSTの<span class="s1">view</span>上に発見できなかった場合、”ss_f_noViewFound” Eventを発行します。</p>
<p class="p14"><br></p>
<p class="p9"><span class="Apple-tab-span">	</span>line[int]</p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Region</span>を表示する行番号です。</p>
<p class="p14"><br></p>
<p class="p9"><span class="Apple-tab-span">	</span>message[string]</p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Region</span>に保存する文字列データです。</p>
<p class="p14"><br></p>
<p class="p9"><span class="Apple-tab-span">	</span>condition[string]</p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Region</span>のカラーリングを決定するパラメータです。</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ST<span class="s3">の</span>Color Scheme<span class="s3">と連動しています。</span></p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SS</span>では、適当ですが、 <span class="s1">keyword</span> パラメータをError用、string パラメータをCaution用に使用しています。</p>
<p class="p14"><br></p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span>e.g. </span>ファイル /Users/USERNAME/Library/Application Support/Sublime Text 2/Packages/SublimeSocket/SublimeSocketAPISettings.py に対して、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>10行目にRegionが表示されます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1"><img src="1__%23$!@%25!%23__%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202013-04-05%200.19.31.png" alt="1__#$!@%!#__スクリーンショット 2013-04-05 0.19.31.png"></span></p>
<p class="p15">ss@appendRegion:</p>
<p class="p15">{</p>
<p class="p15"><span class="Apple-converted-space">    </span>"view": "/Users/USERNAME/Library/Application Support/Sublime Text 2/Packages/SublimeSocket/SublimeSocketAPISettings.py",</p>
<p class="p15"><span class="Apple-converted-space">    </span>"identity": "03/12/13 18:46:17",</p>
<p class="p15"><span class="Apple-converted-space">    </span>"line": 10,</p>
<p class="p15"><span class="Apple-converted-space">    </span>"message": "herecomes daredevil",</p>
<p class="p15"><span class="Apple-converted-space">    </span>"condition": "keyword"</p>
<p class="p15">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><span class="s3"><span class="Apple-tab-span">	</span></span><b>runWithBuffer</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeTextでのファイル編集中のバッファを制御するために使用します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>他のAPIからviewを受け取り、そのviewのバッファに対して、ss_f_runWithBuffer イベントを発生させます。</p>
<p class="p2"><br></p>
<p class="p9"><span class="s3"><span class="Apple-tab-span">	</span>view</span>[sublimetext_view_instance]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeTextのviewオブジェクトです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>インスタンスのため、APIから直に指定する事はできません。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. 選択範囲が変更された際、現在のビューのバッファを ss_f_runWithBuffer イベントのReactorへと送付します。<span class="Apple-converted-space"> </span></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ss_f_runWithBuffer イベントのReactorがセットされていなければ何も発生しません。</p>
<p class="p8">ss@setReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "on_selection_modified",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"runWithBuffer": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"view": "will be replace to specific view"</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>],</p>
<p class="p8"><span class="Apple-converted-space">    </span>"replacefromto": {</p>
<p class="p8"><span class="Apple-converted-space">        </span>"view": "view"</p>
<p class="p8"><span class="Apple-converted-space">    </span>},</p>
<p class="p8"><span class="Apple-converted-space">    </span>"interval": 100</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>notify</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>MacのNotificationCenterを起動し、任意の文字列を表示します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s1"><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202013-04-05%201.08.12.png" alt="スクリーンショット 2013-04-05 1.08.12.png"></span></p>
<p class="p4"><span class="Apple-tab-span">	</span>title[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>タイトル用の文字列です。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>message[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>メッセージ用の文字列です。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>"_"を" "(<span class="s1">space</span>)に勝手に変換します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>debug</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>デバッグ用パラメータです。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>セットされている場合はvalueに応じてデバッグ表示がSTのログに出力されます。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g.</p>
<p class="p8">ss@notify:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"title": "title-is-here",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"message": "message-of-nyaaa"</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>補記：<span class="Apple-tab-span">	</span>Linux、Windowsのことは考えずに作りましたが、下記サンプルでgrowlでの通知が可能です。</p>
<p class="p8">ss@runShell:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"main": "/usr/local/bin/growlnotify",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"-m": "message!",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"-t": "Saved!",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"-a": "\"Sublime Text 2\"",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"debug": true</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>getAllFilePath</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>anchorに指定されたファイルを検索し、検索ヒット後、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ancorファイルがあるフォルダとその下のフォルダ内のすべてのファイルの絶対パスを,で連結した文字列をpathsに保持します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>anchor[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>検索する対象のファイル名です。現在のSublimeTextのWindowBasePathを基準に、ファイルを上位階層へと探しに行きます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>特にリミットが無いため、間違えると永遠に上位フォルダへ検索の手を伸ばします。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>header[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>検索ヒット後、結果の文字列のfooterとして、pathsの前部に接続されます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>footer[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>検索ヒット後、結果の文字列のfooterとして、pathsの後部に接続されます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>paths[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>検索ヒット後、ヒット時のフォルダ以下にあるファイルすべてのpathを,で連結した、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>header+連結済みpath+footer という状態の文字列を保持します。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. readme.txtというファイルを検索し、そのファイルがあるフォルダ以下のすべてのファイルの絶対パスを,で連結した文字列をpathsに格納、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>monocastMessageでクライアントへと送付します。</p>
<p class="p8">ss@getAllFilePath:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"header": "header:",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"anchor": "readme.txt",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"footer": "footer",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"paths": "will be entered"</p>
<p class="p8">}</p>
<p class="p8">-&gt;(paths|message)monocastMessage:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"message": "replace",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference"<span class="Apple-converted-space">   </span></p>
<p class="p8">}</p>
<p class="p16"><span class="s4"><b>RESPONSE: header:/Users/sassembla/Library/Application Support/Sublime Text 2/Packages/SublimeSocket/tmp/preference.html,/Users/sassembla/Library/Application Support/Sublime Text 2/Packages/SublimeSocket/tmp/readme.txtfooter</b></span></p>
<p class="p17"><br></p>
<p class="p2"><br></p>
<p class="p13"><span class="s3"><b><span class="Apple-tab-span">	</span></b></span><b>readFileData</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>特定pathのファイルのデータを読み込みます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>path[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>読み込み対象となるファイルのパス</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>data[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>読み込んだデータが入力されます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. <span class="s1">Python</span>Switch.py というデータを読み出し、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>monocastMessageでクライアントへと送付します。</p>
<p class="p8">ss@readFileData:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"path": "/Users/sassembla/Library/Application Support/Sublime Text 2/Packages/SublimeSocket/PythonSwitch.py",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"data": "will be entered"</p>
<p class="p8">}</p>
<p class="p8">-&gt;(data|message)monocastMessage:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"message": "replace",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference" <span class="Apple-converted-space"> </span></p>
<p class="p8">}</p>
<p class="p16"><span class="s4"><b>RESPONSE: class PythonSwitch(object): def __init__(self, value): self.value = value self.fall = False def __iter__(self): """Return the match method once, then stop""" yield self.match raise StopIteration def match(self, *args): """Indicate whether or not to enter a case suite""" if self.fall or not args: return True elif self.value in args: # changed for v1.5, see below self.fall = True return True else: return False</b></span></p>
<p class="p2"><br></p>
<p class="p13"><span class="s3"><b><span class="Apple-tab-span">	</span></b></span><b>eventEmit</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>独自定義のイベントを定義、発行します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>このAPIで着火できるイベントは、ユーザー定義イベントに限られます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>target[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Eventのターゲット指定に使用する文字列です。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>event[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>発行するEvent名です。<span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e,g, MyTarget の event_MyEventというイベントに対するreactorをセットし、eventEmitでそのイベントを着火します。</p>
<p class="p8">ss@setReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "<span class="s1">MyTar</span>get",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "event_MyEvent",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"monocastMessage": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"message": "eventEmit over.",</p>
<p class="p8"><span class="Apple-converted-space">                </span>"target": "sublimesocketpreference"</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>]</p>
<p class="p8">}</p>
<p class="p8">-&gt;eventEmit:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "<span class="s1">MyTar</span>get",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "event_MyEvent"</p>
<p class="p8">}</p>
<p class="p16"><span class="s4"><b>RESPONSE: eventEmit over.</b></span></p>
<p class="p2"><br></p>
<p class="p13"><span class="s3"><span class="Apple-tab-span">	</span></span><b>openPage</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeTextと接続された状態のHTMLをブラウザで開きます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>HTMLはプラグイン内の tmp フォルダに、identity.htmlとして出力されます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>展開されたページは、SublimeSocket経由のmessageをログとしてHTMLに表示します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Preferenceページの</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>identity[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>展開されるページのWebSocketとしてのidentity指定です。</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. 06_10_13_14_32_08 というidentityを持ったページをブラウザで開きます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>展開されたページへは、monocastMessage, broadcastMessageでメッセージを届けることができ、HTML上に表示されます。</p>
<p class="p8">ss@openPage:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-tab-span">	</span>"identity": "06_10_13_14_32_08"</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><span class="s3"><b><span class="Apple-tab-span">	</span></b></span><b>setWindowBasePath</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeTextで現在開いているファイルの位置を、SSのフォルダ検索の基準位置としてセットします。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ST2とST3で挙動が異なる(ST2だと非同期、ST3だと同期)</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>特にパラメータはありません。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p18"><b></b><br></p>
<p class="p19"><b>Event Reference</b></p>
<p class="p20"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>各Eventについて、setReactor APIでReactorをセットする事が出来ます。</p>
<p class="p4"><span class="Apple-tab-span">	</span>setReactorでcaptureできる各Eventが保持するパラメータについては、各Eventの項を確認してください。</p>
<p class="p2"><br></p>
<p class="p21"><b>SublimeText-Event</b></p>
<p class="p4"><span class="Apple-tab-span">	</span>SublimeTextから発生するEventは下記になります。 発生タイミングなどの詳細は、同名のSublimeTextの<span class="s1">API Reference</span>を参考にしてください。</p>
<p class="p2"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span><b>on_selection_modified, <span class="Apple-converted-space"> </span></b></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>on_pre_save,<span class="Apple-converted-space"> </span></b></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>on_post_save,<span class="Apple-converted-space"> </span></b></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>on_modified</b></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>これらのEventは、Reactorのinterval指定に従って発生判定を行っています。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>一定時間内に複数回発生したとしても、最後に発生したEventのみが、intervalに合わせて処理されます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>REACTIVE_RESERVED_INTERVAL_EVENT<span class="Apple-tab-span">	</span>= ["on_modified", "on_selection_modified", "on_pre_save", "on_post_save"]</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p2"><br></p>
<p class="p4"><b><span class="Apple-tab-span">	</span>Event params</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>すべてのEventが下記paramを発行します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setReactorでは下記paramをreplacefromtoで転用可能。</p>
<p class="p2"><br></p>
<p class="p9"><span class="s3"><span class="Apple-tab-span">	</span>view</span>[sublimetext_view_instance]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeText view</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>viewId[int]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeText<span class="Apple-converted-space">  </span>view.view.id()</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>bufferId[int]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeText view.buffer_id()</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>path[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeText view.file_name()</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>basename[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>os.path.basename(view.file_name())</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>vname[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeText view.name()</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p22"><span class="s5"><b>Sub</b></span><b>limeSocket-Event</b></p>
<p class="p4"><span class="Apple-tab-span">	</span>SublimeSocketから発生するEventは下記になります。</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p23"><b><span class="Apple-tab-span">	</span>foundation series</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>emitEventなどでClientから発行することは不可能です。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>setReactorに対して設定してください。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>ss_f_noViewFound</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>appendRegion API使用時、該当のviewがSTのview内に存在しない = ファイルが開かれていない場合に発行されます。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>発生したタイミングで、Reactorが反応します。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>message[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span>view[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span>line[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span>condition[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>パラメータはすべて、appendRegion APIへと入力された値が使用されます。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. パラメータ例</p>
<p class="p15">{</p>
<p class="p15"><span class="Apple-converted-space">    </span>"view": "/Users/USERNAME/Library/Application Support/Sublime Text 2/Packages/SublimeSocket/SublimeSocketAPISettings.py",</p>
<p class="p15"><span class="Apple-converted-space">    </span>"identity": "03/12/13 18:46:17",</p>
<p class="p15"><span class="Apple-converted-space">    </span>"line": 10,</p>
<p class="p15"><span class="Apple-converted-space">    </span>"message": "herecomes daredevil",</p>
<p class="p15"><span class="Apple-converted-space">    </span>"condition": "keyword"</p>
<p class="p15">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>ss_f_runWithBuffer</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>runWithBuffer イベントの発生を受けて発生します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>runWithBuffer イベント発生時のviewパラメータを受け取り、バッファ上のデータをbodyパラメータに格納します。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>target[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span>view[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span>body[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span>path[string]</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>パラメータはすべて自動的に入力されます。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g.<span class="Apple-converted-space">  </span>選択範囲が変更されると、そのビューのバッファの情報をbodyパラメータに格納し、monocastMessageでクライアントへと送付します。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>サンプルとして、ファイル Default.sublime-commands を開いた状態で選択範囲を変更した際のRESPONSEを載せておきました。</p>
<p class="p8">ss@setReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "ss_f_runWithBuffer",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"replacefromto": {</p>
<p class="p8"><span class="Apple-converted-space">        </span>"body": "message"</p>
<p class="p8"><span class="Apple-converted-space">    </span>},</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"monocastMessage": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"message": "replace",</p>
<p class="p8"><span class="Apple-converted-space">                </span>"target": "sublimesocketpreference"</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>]</p>
<p class="p8">}</p>
<p class="p8">-&gt;setReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "on_selection_modified",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"runWithBuffer": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"view": "will be replace to specific view"</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>],</p>
<p class="p8"><span class="Apple-converted-space">    </span>"replacefromto": {</p>
<p class="p8"><span class="Apple-converted-space">        </span>"view": "view"</p>
<p class="p8"><span class="Apple-converted-space">    </span>},</p>
<p class="p8"><span class="Apple-converted-space">    </span>"interval": 100</p>
<p class="p8">}</p>
<p class="p16"><span class="s4"><b>RESPONSE: [ { "caption": "SublimeSocket: on", "command": "socketon" }, { "caption": "SublimeSocket: on &gt; open preference", "command": "on_then_openpref" }, { "caption": "SublimeSocket: open preference", "command": "openpreference" }, { "caption": "SublimeSocket: status", "command": "statuscheck" }, { "caption": "SublimeSocket: off", "command": "socketoff" } ]</b></span></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p23"><b><span class="Apple-tab-span">	</span>user-defined series</b></p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>”event_”句から始まるユーザー独自定義のイベントを、emit パラメータがあるAPI経由か、emitEvent で発行することが可能です。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>すべてのEventは、emit元が持つパラメータを持ちます。</p>
<p class="p2"><br></p>
<p class="p9"><span class="s3"><span class="Apple-tab-span">	</span></span>e.g.</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event_myEvent</p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event_emitHelloWorld</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>など、event_が付けばなんでもOKです。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p24"><b></b><br></p>
<p class="p25"><b>saveなどのユーザー動作と組み合わせたEventの例</b></p>
<p class="p4"><span class="Apple-tab-span">	</span>・setReactorでユーザーの on_post_save を監視</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>→発生時に動作するEventをselectorに定義</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. setReactorを使い、on_post_save Event発生時に、Hello World とSTのログへと出力します。</p>
<p class="p8">ss@setReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "on_post_save",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"showAtLog": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"message": "Hello World"</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>],</p>
<p class="p8"><span class="Apple-converted-space">    </span>"interval": 1000</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><b></b><br></p>
<p class="p26"><b></b><br></p>
<p class="p27"><b>ユーザーによる範囲選択動作とRegionの選択を組み合わせたEventの例</b></p>
<p class="p4"><span class="Apple-tab-span">	</span>・setReactorでユーザーの on_selection_modified Event を監視</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>→selector中で、containsRegions API をセット、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>該当するview範囲に既設のRegionが含まれているかどうかチェックし、</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>適当なEventをemit</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>・setReactorで上記セットしたEventを監視</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>→selector中で任意の動作を行う</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>e.g. <span class="Apple-tab-span">	</span>appendRegionで実際にRegionを発生させるサンプル。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>on_selection_modifiedに反応するReactor内で、既設のRegionへの反応を記述。範囲がRegionを含んでいた場合、event_errorEmitted Eventを発行。</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>event_errorEmitted Eventが発行された場合、対応するReactorにて、showAtLogが発生する。</p>
<p class="p8">ss@setReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "on_selection_modified",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"containsRegions": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"view": "will be replace to specific view",</p>
<p class="p8"><span class="Apple-converted-space">                </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">                </span>"emit": "event_errorEmitted",</p>
<p class="p8"><span class="Apple-converted-space">                </span>"debug": true</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>],</p>
<p class="p8"><span class="Apple-converted-space">    </span>"replacefromto": {</p>
<p class="p8"><span class="Apple-converted-space">        </span>"view": "view"</p>
<p class="p8"><span class="Apple-converted-space">    </span>},</p>
<p class="p8"><span class="Apple-converted-space">    </span>"interval": 1000</p>
<p class="p8">}</p>
<p class="p8">-&gt;setReactor:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"target": "sublimesocketpreference",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"event": "event_errorEmitted",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"selectors": [</p>
<p class="p8"><span class="Apple-converted-space">        </span>{</p>
<p class="p8"><span class="Apple-converted-space">            </span>"showAtLog": {</p>
<p class="p8"><span class="Apple-converted-space">                </span>"message": "Hello World"</p>
<p class="p8"><span class="Apple-converted-space">            </span>}</p>
<p class="p8"><span class="Apple-converted-space">        </span>}</p>
<p class="p8"><span class="Apple-converted-space">    </span>]</p>
<p class="p8">}</p>
<p class="p8">-&gt;appendRegion:</p>
<p class="p8">{</p>
<p class="p8"><span class="Apple-converted-space">    </span>"view": "/Users/sassembla/Library/Application Support/Sublime Text 2/Packages/SublimeSocket/SublimeSocketAPISettings.py",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"identity": "03/12/13 18:46:17",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"line": 10,</p>
<p class="p8"><span class="Apple-converted-space">    </span>"message": "herecomes daredevil",</p>
<p class="p8"><span class="Apple-converted-space">    </span>"condition": "keyword"</p>
<p class="p8">}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4"><b>サンプルフィルタ</b></p>
<p class="p4"><span class="Apple-tab-span">	</span>いくつか、サンプルのフィルタがあります。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>TypeScript用のフィルタ</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>SublimeSocket/FilterSettingSamples/TypeScriptFilter.txt</p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p4"><span class="Apple-tab-span">	</span>tscが出力するログに対して、エラー行を表示しています。</p>
<p class="p4"><span class="Apple-tab-span">	</span>すべてフィルタやReactorで書かれています。</p>
<p class="p2"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>API runSettingで読み込むとそのまま使える状態ですので、がんばってみてください。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
</body>
</html>
